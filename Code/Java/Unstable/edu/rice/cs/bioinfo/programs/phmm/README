README

******************
File Formats
******************

-> Basic Info File
		This is a .txt file that should contain general information about your 
		sequence files. 

		name format: filename.txt

		Format:
		Line 1) NumberOfSequences (this should be the same number of species)
		Line 2) Legal Alphabet symbols each separated by a space
		Line 3) Species or Taxa each separated by a space (note: this should appear
		in the same order as they are in the sequence files)

		Example:
		3\n
		A C T G\n
		Human Chimp Gorilla\n


- Parental trees file
  - Format: 
    <tree 0 name> <tree 0 in Newick> <gene-genealogy-taxon-to-species-tree-taxon-mapping>
    <tree 1 name> <tree 1 in Newick> <gene-genealogy-taxon-to-species-tree-taxon-mapping>
    ...
    <tree t_p name> <tree t_p in Newick>

  - Duplicate tree IDs are not allowed.
  - Parental tree IDs cannot appear in the gene genealogies file.
  - <gene-genealogy-taxon-to-species-tree-taxon-mapping> is in the following format:
    <gene-genealogy taxon>:<species-tree taxon>,<gene-genealogy taxon>:<species-tree taxon>...

- Gene genealogies file
  - Format: 
    <tree 0 name> <tree 0 in Newick>
    <tree 1 name> <tree 1 in Newick>
    ...
    <tree t_p name> <tree t_p in Newick>

  - Duplicate tree IDs are not allowed.
  - Gene genealogy IDs cannot appear in the parental trees file.

- Hidden state switching parameters
  - Format:
    <parameter name> <minimum weight during optimization> <initial weight> <maximum weight during optimization> <optimize flag> <hidden state x_1 parental tree name>,<hidden state x_1 gene genealogy name>|<hidden state y_1 parental tree name>,<hidden state y_1 gene genealogy name> <hidden state x_2 parental tree name>,<hidden state x_2 gene genealogy name>|<hidden state y_2 parental tree name>,<hidden state y_2 gene genealogy name> ...

  - Duplicate parameter names are not allowed.
  - Set <optimize flag> to true to enable optimization for the parameter, or set to false
    to disable optimization and leave the parameter value fixed for the entire analysis.
  - All possible ordered pairs of hidden states must be specified for each row of hidden states
    (where all hidden states in a row share the same parental tree), 
    *except* for ordered pairs where both members are the same hidden state 
    (corresponding to self-transitions).
  - Switching parameters are ratios, where the self-transition parameter
    is canonically assigned to be 1.
    Ratios of all parameters therefore specify the switching probability,
    s.t. transitions sum to one.
    For example, let H = {H_1, H_2} and 
    ratios be
    ratio(H_1, H_2) = 4
    ratio(H_2, H_1) = 2
    .
    (Recall that
    ratio(H_1, H_1) = 1
    and 
    ratio(H_2, H_2) = 1
    .)
    Then,
    solving for transitions away from H_1,
    4x + 1x = 1
    and therefore 
    P[H_1 -> H_2] = 4/5
    P[H_1 -> H_1] = 1/5
    
    Similarly, solving for transitions away from H_2,
    P[H_2 -> H_1] = 2/3
    P[H_2 -> H_2] = 1/3

- Sequence File
		This .seq file will contain all the observations sequence of the given
		genomes.

		Format:
		line 1) LengthOfSequence
		line 2) Type1 Sequence
		line 3) Type2 Sequence
		line 4) Type3 Sequence
				.
				.
				.

		Example:
		5\n
		human ACTGA\n
		gorilla TATAG\n
		chimp CCCTG\n

		Important notes: order of taxa sequence here MUST MATCH the order given
						in the basic info file.
		****A Newline character is important to terminate every sequence line
		
- Parental branch length parameters file
  - Format:
    <parameter name> <initial weight> <edge ID in <tree ID>,<child node ID>,<parent node ID> format>
    ...

- Parental branch length parameter strict inequalities file
  - A parameter name can appear only ONCE in this file.
  - A dependent parental branch length parameter is constrained to be $\leq$ than another
    parental branch length parameter + \epsilon, where \epsilon is a small value.
  - Format:
    <lesser parameter name> <greater parameter name>
    ...

    where the constraint is <lesser parameter name> < <greater parameter name>

- Length-parameter constraint sets file
  - A parental-branch-length-parameter cannot belong to more than one constraint-set.
  - Format:
  <set name> <total weight of constraint-set> <parameter 1 name> <parameter 2 name> ...
  ...

*********************************************************************
Compilation Requirements and Instructions on how to Use Luay's JAHMM
*********************************************************************
Need to have at hand:
	1. a basic info file
	2. a trees file
	3. a state transition probability matrix
	4. initial state probabilities

Compile the project with the included junit3.8.jar in the build path

Run runHmm.java file.
Follow the instructions and provide appropriate inputs


***************************************
Credits
***************************************
Our Hmm model is a modified of the JaHmm
	- http://www.run.montefiore.ulg.ac.be/~francois/software/jahmm/
Our TreeParser is a slightly modified version of James
	- https://github.com/PMSeitzer/JContextExplorer/blob/master/JContextExplorer/src/newickTreeParsing/TreeParser.java

 


